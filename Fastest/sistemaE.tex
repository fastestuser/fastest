\documentclass[submission,copyright]{myeptcs}
\usepackage[latin1]{inputenc}
\usepackage[spanish]{babel}
\usepackage{savesym}
\savesymbol{hbar}
\usepackage{z-eves}

\newenvironment{designations}{\begin{list}{}{\setlength{\labelsep}{0cm}\setlength{\labelwidth}{0cm}\setlength{\listparindent}{0cm}\setlength{\rightmargin}{\leftmargin}}}{\end{list}}

%\newenvironment{theorem}[1]{\vspace{3mm}\noindent\textbf{Theorem} #1 \[}{\]}

\newcommand{\desig}[2]{\item #1 $\approx #2$}

\title{Especificación Z del Sistema Elecciones del Consejo Nacional de Investigaciones Científicas y Técnicas de la \\ República Argentina}

\author{Maximiliano Cristiá\footnote{Profesor de Ingeniería de Software en la Universidad Nacional de Rosario (UNR). Director del Grupo de Ingeniería de Software del Centro Internacional Franco-Argentino de Ciencias de la Información y de Sistemas (CIFASIS), dependiente del CONICET, UNR y Universidad de Marsella (Francia).}
\institute{CIFASIS y UNR\\ Rosario, Argentina}
\email{cristia@cifasis-conicet.gov.ar}
}
\def\titlerunning{Especificación Z del Sistema Elecciones}
\def\authorrunning{Maximiliano Cristiá}

\begin{document}
\maketitle

\begin{abstract}
El presente documento describe la especificación funcional en lenguaje Z del Sistema Elecciones del Consejo Nacional de Investigaciones Científicas y Técnicas (CONICET). Esta especificación se escribió a partir del Reglamento del Sistema Electoral, aprobado por el Directorio del CONICET en sus reuniones de los días 9 y 10 de noviembre de 2011, y de consultas realizadas al personal de la Gerencia de Organización y Sistemas del mencionado organismo.

Este documento forma parte de las actividades de revisión del Sistema Elecciones que fueran solicitadas por la Gerencia de Organización y Sistemas al Centro Internacional Franco-Argentino de Ciencias de la Información y de Sistemas (CIFASIS). El objetivo de esta especificación es contar con una descripción precisa de los requerimientos del Sistema Elecciones a fin de poder determinar la corrección funcional de su implementación.
\end{abstract}

\section{Tipos básicos}

En esta sección se introducen los tipos básicos, tipos enumerados y algunas definiciones axiomáticas de la especificación.

\subsection{Grandes Áreas del Conocimiento y regiones electorales}
El Reglamento del Sistema Electoral (RSE) del CONICET prevé la realización de una elección por cada Gran Área del Conocimiento (GAC) existente dentro de este organismo. Sin embargo, en esta oportunidad el CONICET convoca a elecciones solo a las siguientes GAC: Ciencias Exactas y Naturales, y Ciencias Agrarias, Ingenierías y de Materiales. En consecuencia introducimos un tipo enumerado para las GAC:

\begin{zed}
GAC ::= cen | caim | nil
\end{zed}

\noindent donde el significado de cada término elemental queda determinado por las siguientes designaciones\footnote{De aquí en más omitiremos mencionar que el significado de los términos elementales está dado por designaciones, y simplemente las introduciremos.}:

\begin{designations}
\desig{Gran Área del Conocimiento llamada Ciencias Exactas y Naturales}{cen}
\desig{Gran Área del Conocimiento llamada Ciencias Agrarias, Ingenierías y de Materiales}{caim}
\desig{Cualquier Gran Área del Conocimiento que no sea una de las dos anteriores}{nil}
\end{designations}

El elemento $nil$ es introducido solo a los fines de contar con algún GAC que no forme parte de la actual convocatoria a elecciones. Se debe eliminar una vez que se hayan enumerado todas las GAC del CONICET.

Por otro lado, el Sistema Elecciones (SE) del CONICET deberá estar preparado para ejecutar una elección en cualquiera de las GAC existentes en el CONICET, y no solo en las dos que son motivo de esta convocatoria. En consecuencia el tipo $GAC$ deberá ser ampliado con las otras GAC cuando sea necesario.

Cada elección se realiza para una o más de las GAC que existen en el CONICET, por lo tanto definimos un parámetro cuyo valor indicará la o las GAC que participan de la elección.

\begin{axdef}
gacsCom: \power GAC
\where
gacsCom \neq \emptyset
\end{axdef}

\begin{designations}
\desig{Las Grandes Áreas del Conocimiento para las cuales se eligen candidatos en estos comicios}{gacsCom}
\end{designations}

El RSE prevé también que el territorio nacional esté dividido en ocho regiones electorales las cuales afectan el modo en que los electores deben emitir su voto, como se verá más adelante. En consecuencia introducimos el siguiente tipo:

\begin{zed}
RE ::= metro | centro | pampa | sur | litoral | cuyo | nea | noa
\end{zed}

\begin{designations}
\desig{Región electoral llamada METROPOLITANA}{metro}
\desig{Región electoral llamada CENTRO}{centro}
\desig{Región electoral llamada PAMPEANA}{pampa}
\desig{Región electoral llamada SUR}{sur}
\desig{Región electoral llamada LITORAL}{litoral}
\desig{Región electoral llamada CUYO}{cuyo}
\desig{Región electoral llamada NORDESTE}{nea}
\desig{Región electoral llamada NOROESTE}{noa}
\end{designations}

\subsection{Electores}
Según el RSE los electores para estas elecciones son todos los miembros (activos o jubilados) de la Carrera de Investigador Científico y Tecnológico del CONICET que cumplan ciertas condiciones. En consecuencia introducimos el siguiente tipo que identifica a todas esas personas:

\begin{zed}
[INVEST]
\end{zed}

\begin{designations}
\desig{$x$ es un miembro (activo o jubilado) de la Carrera de Investigador Científico y Tecnológico del CONICET}{x \in INVEST}
\end{designations}

El RSE establece las siguientes condiciones para que un miembro de $INVEST$ sea un elector:

\begin{enumerate}
\item Si la persona es un investigador jubilado, debe estar contratado con anterioridad al 31 de diciembre de 2011\footnote{Notar que el RSE dice ``con anterioridad al 31 de diciembre de 2011'', lo cual parece decir que alguien contratado el mismo 31 de diciembre no puede ser elector.}.
\item La persona debe pertenecer a una de las GAC aludidas en este reglamento.
\item La persona debe estar debidamente identificada en la Intranet del CONICET.
\end{enumerate}

Por lo tanto, introducimos los siguientes términos formales. En primer lugar el conjunto de miembros de $INVEST$ que son jubilados.

\begin{axdef}
jub: \power INVEST
\where
jub \neq \emptyset
\end{axdef}

\begin{designations}
\desig{$x$ es un miembro jubilado de la Carrera de Investigador Científico y Tecnológico del CONICET}{x \in jub}
\end{designations}

En segundo lugar, definimos el conjunto de todos los $jub$ que han sido contratados por el CONICET con anterioridad al 31 de diciembre de 2011.

\begin{axdef}
jubContr: \power INVEST
\where
jubContr \neq \emptyset \\
jubContr \subseteq jub
\end{axdef}

\begin{designations}
\desig{$x$ es un miembro jubilado de la Carrera de Investigador Científico y Tecnológico del CONICET contradado por este con anterioridad al 31 de diciembre de 2011}{x \in jubContr}
\end{designations}

Luego definimos funciones que asocian cada miembro de $INVEST$ con su $GAC$ y su $RE$, respectivamente.

\begin{axdef}
miGAC: INVEST \fun GAC \\
miRE: INVEST \fun RE
\end{axdef}

\begin{designations}
\desig{El Gran Área del Conocimiento del miembro (activo o jubilado), $x$, de la Carrera de Investigador Científico y Tecnológico del CONICET\footnote{En Z la aplicación de una función a su argumento puede escribirse como en matemática, $f(x)$, o sin los paréntesis pero separando el nombre de la función de su argumento con un espacio, $f~x$.}}{miGAC~x}
\desig{La región electoral a la cual pertenece el miembro (activo o jubilado), $x$, de la Carrera de Investigador Científico y Tecnológico del CONICET}{miRE~x}
\end{designations}

Finalmente, introducimos el conjunto de todos los miembros de $INVEST$ que están debidamente identificados en la Intranet del CONICET.

\begin{axdef}
enIntranet: \power INVEST
\where
enIntranet \neq \emptyset
\end{axdef}

\begin{designations}
\desig{$x$ es un miembro (activo o jubilado) de la Carrera de Investigador Científico y Tecnológico del CONICET debidamente identificado en la Intranet del CONICET}{x \in enIntranet}
\end{designations}

\subsection{Candidatos}
En cuanto a los electores que pueden ser candidatos el RSE indica que pueden serlo los investigadores (activos o jubilados) de las categorías Superior, Principal e Independiente, que además cumplan con otras condiciones. Por lo tanto, definimos un tipo para las categorías de investigador, el conjunto de categorías que permiten ser candidato y una función que asocia a cada miembro de $INVEST$ con su categoría.

\begin{zed}
CAT ::= principal | superior | indep | otra
\end{zed}

\begin{designations}
\desig{La categoría de investigador del CONICET llamada Principal}{principal}
\desig{La categoría de investigador del CONICET llamada Superior}{superior}
\desig{La categoría de investigador del CONICET llamada Independiente}{indep}
\desig{Cualquier otra categoría de investigador del CONICET que no sea una de las anteriores}{otra}
\end{designations}

\begin{axdef}
candCAT: \power CAT \\
miCAT: INVEST \fun CAT
\where
candCAT = \{principal, superior, indep\}
\end{axdef}

\begin{designations}
\desig{Categoría de investigador del CONICET de la persona $x$}{miCAT~x}
\end{designations}

Una de las condiciones que un $INVEST$ debe cumplir para poder ser candidato es no adeudar rendiciones de cuentas de subsidios ni informes académicos. Los siguientes conjuntos reúne a aquellos miembros que adeudan esos documentos.

\begin{axdef}
adRendi, adInfo: \power INVEST
\end{axdef}

\begin{designations}
\desig{$x$ es un miembro (activo o jubilado) de la Carrera de Investigador Científico y Tecnológico del CONICET que adeuda al menos una rendición de cuentas de algún subsidio}{x \in adRendi}
\desig{$x$ es un miembro (activo o jubilado) de la Carrera de Investigador Científico y Tecnológico del CONICET que adeuda al menos un informe académico}{x \in adInfo}
\end{designations}

Tampoco puede ser candidato quien haya sido sancionado por razones disciplinarias con una suspensión de cinco o más días en los últimos cuatro años hasta el 31 de diciembre de 2011. Por lo tanto definimos un conjunto para quienes cumplen esta condición.

\begin{axdef}
sancionados: \power INVEST
\end{axdef}

\begin{designations}
\desig{$x$ es un miembro (activo o jubilado) de la Carrera de Investigador Científico y Tecnológico del CONICET que ha sido sancionado por razones disciplinarias con una suspensión de cinco o más días en los últimos cuatro años hasta el 31 de diciembre de 2011}{x \in sancionados}
\end{designations}


\subsection{Fechas límite}
En esta sección definimos algunas de las fechas límite que deben cumplirse para que el acto comicial se desarrolle según el RSE y que se relacionan con el funcionamiento del Sistema Elecciones. Consideramos que a este nivel las fechas pueden representarse como números naturales entendiendo que cada uno representa un día diferente del calendario. Para mejorar la legibilidad de la especificación definimos un sinónimo como sigue.

\begin{zed}
FECHA == \nat
\end{zed}

\begin{designations}
\desig{El día número $f$ del calendario}{f \in FECHA}
\end{designations}

Con el fin de hacer la especificación más general (y por consiguiente útil para varios comicios) definiremos fechas abstractas pero que cumplan las relaciones de orden indicadas en el RSE. 

\begin{axdef}
iAval, fAval, iVoto, fVoto: FECHA \\
pAval, pLegal, pVoto: \nat
\where
pAval > 0 \\
pLegal > 0 \\
pVoto > 0 \\
fAval = iAval + pAval \\
iVoto = fAval + pLegal \\
fVoto = iVoto + pVoto
\end{axdef}

\begin{designations}
\desig{Inicio del período para registrar avales}{iAval}
\desig{Fin del período para registrar avales}{fAval}
\desig{Duración del período para registrar avales}{pAval}
\desig{Duración del período para revisar listas de candidatos}{pLegal}
\desig{Inicio del período para emitir el voto}{iVoto}
\desig{Fin del período para emitir el voto}{fVoto}
\desig{Duración del período para emitir el voto}{pVoto}
\end{designations}


\subsection{Mensajes}
Las operaciones que definiremos más adelante deben emitir ciertos mensajes que representan el éxito o fracaso de su ejecución. Por lo tanto, definimos el siguiente tipo.

\begin{zed}
MENSAJES ::= \\
  \t1 ok \\
  \t1 | sinCandidatos \\
  \t1 | listaCandidatosInconsistente \\
  \t1 | fechaErronea \\
  \t1 | investNoPuedeVotar \\
  \t1 | noEsCandidato \\
  \t1 | GACIncorrecta \\
  \t1 | yaHaAvalado \\
  \t1 | yaHaVotado \\
  \t1 | muchosCandidatos \\
  \t1 | REIncorrecta
\end{zed}

\section{Estado del Sistema Elecciones}\label{estado}
Consideramos que el estado del Sistema Elecciones queda fielmente representado por los siguientes esquemas de estado. Decidimos dividir el esquema de estado en tres esquemas con el fin de, más adelante, simplificar la especificación de las operaciones. El esquema de estado es, entonces:


El esquema $Avales$ agrupa las variables de estado relacionadas con el proceso para avalar candidatos.

\begin{schema}{Avales}
cand: INVEST \pfun GAC \\
avales: INVEST \pfun \finset INVEST 
\end{schema}

\begin{designations}
\desig{$x$ es un miembro (activo o jubilado) de la Carrera de Investigador Científico y Tecnológico del CONICET que se ha postulado como candidato para la Gran Área del Conocimiento $a$}{x \mapsto a \in cand}
\desig{El miembro (activo o jubilado) de la Carrera de Investigador Científico y Tecnológico del CONICET $x$ avala al candidato $c$}{x \in avales~c}
\end{designations}

La variable $cand$ almacenará los $INVEST$ que se postulen como candidatos. Luego los electores podrán avalar a un miembro de $cand$. 

El esquema de estado $Votos$ agrupa las variables que se utilizan durante la votación. Para poder iniciar los comicios se deben definir aquellos candidatos que han logrado los avales necesarios. Para esto se define la variable $candfin$ que solo registrará los ``nombres'' de los candidatos puesto que la GAC correspondiente puede obtenerse de $cand$. Una vez que comiencen los comicios se debe registrar quiénes han votado (con el fin de que no voten más de una vez), variable $hanVotado$, y los votos emitidos en cada momento, variable $votos$ (notar que esta variable no puede tener tipo $\finset (\finset INVEST)$ porque de esa forma de dos votos idénticos solo quedaría registrado uno). 
 
\begin{schema}{Votos}
hanVotado: \finset INVEST \\
votos: \seq (\finset INVEST) \\
candfin: \power INVEST \\
\end{schema}

\begin{designations}
\desig{$x$ es un miembro (activo o jubilado) de la Carrera de Investigador Científico y Tecnológico del CONICET que ha sido confirmado como candidato}{x \in candfin}
\desig{Votos emitidos hasta el momento}{votos}
\desig{El miembro (activo o jubilado) de la Carrera de Investigador Científico y Tecnológico del CONICET $x$ ha emitido su voto}{x \in hanVotado}
\end{designations}

A los fines del RSE y del Sistema Elecciones es suficiente con llevar la cuenta del tiempo con una precisión de días. Por lo tanto, definimos una variable cuyo valor registra la fecha actual que cambiará con el paso de un día\footnote{Tener en cuenta que Z no es un lenguaje de especificación especialmente bien dotado para describir requisitos temporales.}.

\begin{schema}{Tiempo}
hoy: FECHA
\end{schema}

\begin{designations}
\desig{Fecha actual}{hoy}
\end{designations}

\begin{schema}{SE}
Avales \\
Votos \\
Tiempo
\end{schema}

\subsection{El estado inicial}
Consideramos que el estado inicial del Sistema Elecciones es aquel en que todas las variables de estado están vacías.

\begin{schema}{Inicial}
SE
\where
cand = \emptyset \\
candfin = \emptyset \\
hanVotado = \emptyset \\
avales = \emptyset \\
votos  = \langle \rangle \\
hoy = 0
\end{schema}


\subsection{Algunos invariantes de estado}
Antes de establecer los invariantes de estado de la especificación es conveniente definir dos conjuntos que luego también usaremos en la especificación de las operaciones. El primer conjunto reúne las condiciones que un $INVEST$ debe cumplir para poder votar. Podría considerarse que este conjunto define el padrón electoral definitivo.

\begin{zed}
PuedenVotar == \\
  \t1 \{i:INVEST | 
          miGAC~i \in gacsCom \land (i \in jub \implies i \in jubContr) \land i \in enIntranet\}
\end{zed}

El segundo conjunto reúne las condiciones para que un $INVEST$ pueda ser candidato de una cierta $GAC$ (sin tener en cuenta los avales).

\begin{zed}
PuedenSerCandidatos == \\
  \t1 \{i:INVEST; a:GAC | \\
    \t2 i \in PuedenVotar \\
    \t2 \land miCAT~i \in candCAT \land
        miGAC~i = a \land
        i \notin adRendi \land
        i \notin adInfo \land
        i \notin sancionados\}
\end{zed}

Entonces los invariantes son los siguientes (ver comentarios más abajo).

\begin{schema}{Invariantes}
SE
\where
%cand tiene que ser gente que pueda ser candidato \\
cand \subseteq PuedenSerCandidatos \\
\dom avales = \dom cand \\
%el rango de avales tienen que ser gente que pueda votar \\
\bigcup (\ran avales) \subseteq PuedenVotar \\
%solo se puede avalar a un candidato con la misma GAC que la propia
\forall i: \dom avales @ 
  avales~i \neq \emptyset \implies \{miGAC~i\} = miGAC \limg avales~i \rimg \\
\forall i,j: \dom avales | i \neq j @ avales~i \cap avales~j = \emptyset \\
hoy \leq fAval \implies candfin = \emptyset \\
fAval < hoy \implies candfin = \dom (avales \rres \{A:\ran avales | 20 \leq \# A\}) \\
hoy < iVoto \implies hanVotado = \emptyset \land votos = \langle \rangle \\
\bigcup (\ran votos) \subseteq candfin \\
\# votos = \# hanVotado \\
%en hanVotado solo puede haber gente que pueda votar
hanVotado \subseteq PuedenVotar
\end{schema}

La justificación o explicación para cada invariante es la siguiente:

\begin{itemize}
%cand tiene que ser gente que pueda ser candidato \\
\item $cand \subseteq PuedenSerCandidatos$

Solo aquellos miembros de $INVEST$ que reúnan ciertas condiciones respecto de sí mismos y de su $GAC$ pueden ser candidatos. Por consiguiente, en todo momento, $cand$ solo puede contener posibles candidatos.

\item $\dom avales = \dom cand$

Los electores solo pueden avalar a los candidatos que hayan sorteado todos los filtros indicados en $PuedenSerCandidatos$. Entonces, en todo momento, solo miembros de $cand$ pueden haber sido avalados.

%el rango de avales tienen que ser gente que pueda votar
\item $\bigcup (\ran avales) \subseteq PuedenVotar$

Solo los miembros de $INVEST$ que puedan votar pueden avalar a los candidatos. En consecuencia, en todo momento, si alguien emitió un aval, sin importar a qué candidato, es porque puede votar.

%solo se puede avalar a un candidato con la misma GAC que la propia
\item $\forall i: \dom avales @ \{miGAC~i\} = miGAC \limg avales~i \rimg$

Según el RSE un elector solo puede avalar a un candidato que se postule para su GAC. Por lo tanto, en todo momento, el conjunto de electores que avaló a un candidato debe tener una única $GAC$ que a su vez es la misma que la del candidato.

\item $\forall i,j: \dom avales | i \neq j @ avales~i \cap avales~j = \emptyset$

Cada elector solo puede avalar a un único candidato. Entonces, si alguien figura entre los avales de un candidato no puede figurar entre los de ningún otro. En consecuencia, tomando los conjuntos de personas que han avalado a dos candidatos distintos, la intersección de  ellos debe ser vacía. 

\item $hoy \leq fAval \implies candfin = \emptyset$

Mientras no haya terminado el período para la búsqueda de avales, no puede haber un listado de candidatos definitivos.

\item $fAval < hoy \implies candfin = \dom (avales \rres \{A:\ran avales | 20 \leq \# A\})$

Cuando haya concluido el período de búsqueda de avales, solo pueden ser candidatos definitivos aquellos miembros de $cand$ que hayan juntado 20 avales o más. Además, a partir de ese momento, esos candidatos definitivos tienen que ser siempre los mismos.

\item $hoy < iVoto \implies hanVotado = \emptyset \land votos = \emptyset$

Mientras no se haya iniciado el período de votación nadie puede haber votado. En consecuencia, antes de esa fecha, no se han emitido votos.

\item $\bigcup (\ran votos) \subseteq candfin$

Cada voto solo puede contener candidatos definitivos.

\item $\# votos = \# hanVotado$

La cantidad de votos emitida debe coincidir con los electores que emitieron su voto.

%en hanVotado solo puede haber gente que pueda votar
\item $hanVotado \subseteq PuedenVotar$

Solo pueden votar personas que estén habilitadas a hacerlo.
\end{itemize}


\section{Las operaciones}
Siguiendo lo expresado en el RSE consideramos las siguientes operaciones para el modelo:

\begin{itemize}
\item Publicar la lista preliminar de candidatos. Es decir, personal del CONICET carga en el sistema la lista de candidatos que buscan los avales necesarios para poder participar en las elecciones.
\item Avalar a un candidato. Es decir, la operación que permite que un elector avale a un candidato preliminar.
\item Publicar la lista de candidatos definitivos. Es decir, personal del CONICET (o el Sistema Elecciones mismo) carga en el sistema aquellos candidatos preliminares que han conseguido 20 o más avales.
\item Emitir el voto. Es la operación que permite que un elector emita su voto.
\item Contar los votos. Es la operación que permite que personal del CONICET consulte al sistema para conocer el resultado del escrutinio.
\end{itemize}

Consideramos que ninguna de las operaciones consume tiempo. Es decir, durante la ejecución de cualquiera de ellas la variable $hoy$ no cambia de valor (lo que se expresa al incluir el esquema $\Xi Tiempo$ en cada operación). Creemos que esto es razonable dado que $hoy$ lleva la cuenta del tiempo con una precisión de un día y cada una de estas operaciones no puede demorar, en el peor de los casos, más de unos pocos segundos.

Para cada operación documentamos además sus variables de entrada y salida (las de estado ya fueron documentadas en la Sección \ref{estado}).

\subsection{Emitir el voto}
Una vez finalizado el período de avales da comienzo el período de votación. Durante este período los miembros de $INVEST$ habilitados para votar, pero que ya no hayan votado, pueden emitir su voto por hasta tres candidatos definitivos de su GAC, cada uno de una región electoral distinta, o votar en blanco. Notar que se tienen en cuenta todas las condiciones:

\begin{itemize}
\item El voto se emite dentro del período correspondiente.
\item El elector está habilitado para votar.
\item El elector es la primera vez que vota.
\item Quiere votar por cero (voto en blanco), uno, dos o tres candidatos.
\item Todos los candidatos por los que quiere votar son candidatos definitivos.
\item Todos los candidatos por los que quiere votar pertenecen a la misma GAC que la del votante.
\item Todos los candidatos por los que quiere votar pertenecen a regiones electorales diferentes entre sí.
\end{itemize}

Si se cumplen todas estas condiciones se agrega al elector al conjunto de electores que ya emitieron su voto y se registra el voto para su posterior escrutinio.

\vspace{5mm}\textbf{Interfaz}
\begin{designations}
\desig{Elector que desea avalar a un candidato}{e?}
\desig{Candidatos por los cuales el elector desea votar}{C?}
\desig{Mensaje de salida emitido por el sistema al finalizar la ejecución de la operación}{rsp!}
\end{designations}

\begin{schema}{VotarPositivo}
\Delta Votos; \Xi Avales; \Xi Tiempo \\
e?:INVEST \\
C?: \finset INVEST \\
rsp!: MENSAJES
\where
iVoto \leq hoy \leq fVoto \\
e? \in PuedenVotar \\
e? \notin hanVotado \\
0 \leq \# C? \leq 3 \\
C? \subseteq candfin \\
\{miGAC~e?\} = miGAC \limg C? \rimg \\
\# C? = \# (miRE \limg C? \rimg) \\
hanVotado'= hanVotado \cup \{e?\} \\
votos' = votos \cat \langle C? \rangle \\
candfin' = candfin
\end{schema}

A continuación describimos los casos en que el voto es inválido. El primer caso corresponde al intento de votar fuera del período correspondiente.

\begin{schema}{VotarFechaErronea}
\Xi SE \\
rsp!: MENSAJES 
\where
hoy < iVoto \lor fVoto < hoy \\
rsp! = fechaErronea
\end{schema}


El segundo caso corresponde a un miembro de $INVEST$ que no está habilitado a votar. Como esta condición es la misma que la del esquema $ElectorNoPuedeVotar$ definido más arriba, no escribimos un nuevo esquema sino que usaremos aquel cuando ensamblemos la operación final. El tercer caso es el de un elector que ya ha emitido su voto.

\begin{schema}{YaVoto}
\Xi SE \\
e?: INVEST \\
rsp!: MENSAJES 
\where
e? \in hanVotado \\
rsp! = yaHaVotado
\end{schema}

El siguiente caso describe a un elector que pretende votar por más de tres candidatos.

\begin{schema}{VotaMasDeTres}
\Xi SE \\
C?: \finset INVEST \\
rsp!: MENSAJES 
\where
\# C? > 3 \\
rsp! = muchosCandidatos
\end{schema}

Otra posibilidad es que intente votar por miembros de $INVEST$ que no son candidatos definitivos.

\begin{schema}{VotaNoCandidatos}
\Xi SE \\
C?: \finset INVEST \\
rsp!: MENSAJES 
\where
\lnot C? \subseteq candfin \\
rsp! = noEsCandidato
\end{schema}

Otro caso es aquel en que el elector quiere votar por uno o más candidatos que no son de su misma GAC.

\begin{schema}{GACCandidatosIncorrecta}
\Xi SE \\
e?:INVEST \\
C?: \finset INVEST \\
rsp!: MENSAJES 
\where
\{miGAC~e?\} \neq miGAC \limg C? \rimg \\
rsp! = GACIncorrecta
\end{schema}

La última posibilidad es que el elector intente votar por candidatos que no son de regiones electorales diferentes entre sí.

\begin{schema}{RECandidatosIncorrecta}
\Xi SE \\
C?: \finset INVEST \\
rsp!: MENSAJES 
\where
\# C? \neq \# (miRE \limg C? \rimg) \\
rsp! = REIncorrecta
\end{schema}

\begin{schema}{ElectorNoPuedeVotar}
\Xi SE \\
e?:INVEST \\
rsp!:MENSAJES
\where
e? \notin PuedenVotar \\
rsp! = investNoPuedeVotar
\end{schema}

Entonces ahora estamos en condiciones de ensamblar la operación final.

\begin{zed}
Votar == \\
  \t1 VotarPositivo \\
  \t1 \lor VotarFechaErronea \\
  \t1 \lor ElectorNoPuedeVotar \\
  \t1 \lor YaVoto \\
  \t1 \lor VotaMasDeTres \\
  \t1 \lor VotaNoCandidatos \\
  \t1 \lor GACCandidatosIncorrecta \\
  \t1 \lor RECandidatosIncorrecta
\end{zed}

\end{document}
